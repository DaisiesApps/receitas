"use strict";(self.webpackChunkreceitas=self.webpackChunkreceitas||[]).push([[478],{9478:(K,g,r)=>{r.r(g),r.d(g,{RecipeEditComponent:()=>b});var p=r(6814),l=r(6223),s=r(4581),u=r(2296),m=r(5195),T=r(7700),f=r(9157),E=r(1175),Z=r(2032),C=r(8525),v=r(4104),O=r(6792),t=r(5879),d=r(2977),x=r(3680);function A(e,a){if(1&e&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&e){const i=a.$implicit;t.Q6J("value",i.id),t.xp6(1),t.Oqu(i.name)}}function h(e,a){if(1&e&&(t.TgZ(0,"mat-form-field",16)(1,"mat-label"),t._uU(2,"Type"),t.qZA(),t.TgZ(3,"mat-select",20),t.YNc(4,A,2,2,"mat-option",21),t.qZA()()),2&e){const i=a.ngIf;t.xp6(4),t.Q6J("ngForOf",i)}}function P(e,a){if(1&e&&(t.TgZ(0,"div",14),t._UZ(1,"input",15),t.TgZ(2,"mat-form-field",16)(3,"mat-label"),t._uU(4,"Nom"),t.qZA(),t._UZ(5,"input",17),t.qZA(),t.YNc(6,h,5,1,"mat-form-field",18),t.ALo(7,"async"),t.TgZ(8,"mat-form-field",16)(9,"mat-label"),t._uU(10,"Nombre de personnes"),t.qZA(),t._UZ(11,"input",19),t.qZA()()),2&e){const i=t.oxw();t.xp6(6),t.Q6J("ngIf",t.lcZ(7,1,i.types$))}}function M(e,a){1&e&&(t.TgZ(0,"p"),t._uU(1," Ajouter un ou plusieurs ingr\xe9dients "),t.qZA())}function I(e,a){if(1&e&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&e){const i=a.$implicit;t.Q6J("value",i.id),t.xp6(1),t.Oqu(i.name)}}function U(e,a){if(1&e&&(t.TgZ(0,"mat-form-field",16)(1,"mat-label"),t._uU(2,"Unit\xe9"),t.qZA(),t.TgZ(3,"mat-select",26),t.YNc(4,I,2,2,"mat-option",21),t.qZA()()),2&e){const i=a.ngIf;t.xp6(4),t.Q6J("ngForOf",i)}}function y(e,a){if(1&e){const i=t.EpF();t.TgZ(0,"div",23),t._UZ(1,"input",24),t.TgZ(2,"mat-form-field",16)(3,"mat-label"),t._uU(4,"Nom"),t.qZA(),t._UZ(5,"input",17),t.qZA(),t.TgZ(6,"mat-form-field",16)(7,"mat-label"),t._uU(8,"Quantit\xe9"),t.qZA(),t._UZ(9,"input",25),t.qZA(),t.YNc(10,U,5,1,"mat-form-field",18),t.ALo(11,"async"),t.TgZ(12,"button",5),t.NdJ("click",function(){const _=t.CHM(i).index,c=t.oxw();return t.KtG(c.removeIngredient(_))}),t.TgZ(13,"mat-icon"),t._uU(14,"delete"),t.qZA()()()}if(2&e){const i=a.index,n=t.oxw();t.Q6J("formGroupName",i),t.xp6(1),t.Q6J("value",-1),t.xp6(9),t.Q6J("ngIf",t.lcZ(11,3,n.units$))}}function R(e,a){1&e&&(t.TgZ(0,"p"),t._uU(1," Ajouter une ou plusieurs \xe9tapes "),t.qZA())}function N(e,a){if(1&e){const i=t.EpF();t.TgZ(0,"div",27),t._UZ(1,"input",28),t.TgZ(2,"mat-form-field",16)(3,"mat-label"),t._uU(4,"Description"),t.qZA(),t._UZ(5,"input",29),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){const _=t.CHM(i).index,c=t.oxw();return t.KtG(c.removeStep(_))}),t.TgZ(7,"mat-icon"),t._uU(8,"delete"),t.qZA()()()}2&e&&(t.Q6J("formGroupName",a.index),t.xp6(1),t.Q6J("value",-1))}const D=function(){return["/"]};let b=(()=>{var e;class a extends O.D{constructor(n,o,_,c,J,q,L){super(n,o,_,c),this.mappingService=J,this.router=q,this.route=L,this.recipeService.get(this.route.snapshot.params.id).subscribe(F=>{this.setRecipeForm(F)})}createRecipe(){let o=this.mappingService.mapRecipeValues(this.form.value);this.recipeService.update(o).subscribe({error:_=>console.log("Erreur :"+_),complete:()=>this.router.navigate(["/recipes/",o.id])})}setRecipeForm(n){this.form.reset(),this.recipeId.setValue(n.id),this.name.setValue(n.name),this.type.setValue(n.type),this.numberOfPeople.setValue(n.numberOfPeople);for(let o of n.ingredients)this.setIngredient(o);for(let o of n.steps)this.setStep(o)}setIngredient(n){const o=this.fb.group({ingredientId:[n.ingredientId,l.kI.min(0)],name:[n.name,l.kI.required],quantity:[n.quantity,l.kI.required],unity:[n.unity]});this.ingredients.push(o)}setStep(n){const o=this.fb.group({stepId:[n.stepId,l.kI.min(0)],description:[n.description,l.kI.required]});this.steps.push(o)}}return(e=a).\u0275fac=function(n){return new(n||e)(t.Y36(l.qu),t.Y36(d.j$),t.Y36(d.SM),t.Y36(d._f),t.Y36(d.yw),t.Y36(s.F0),t.Y36(s.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-recipe-edit"]],standalone:!0,features:[t.qOj,t.jDz],decls:31,vars:11,consts:[[1,"form",3,"formGroup","ngSubmit"],["class","description",4,"ngIf"],[1,"content"],[1,"column"],[1,"column-title"],["mat-icon-button","","type","button",3,"click"],["formArrayName","ingredients",1,"column-content"],[4,"ngIf"],["class","ingredient",3,"formGroupName",4,"ngFor","ngForOf"],["formArrayName","steps",1,"column-content"],["class","step",3,"formGroupName",4,"ngFor","ngForOf"],[1,"actions"],["mat-flat-button","","type","button",3,"routerLink"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],[1,"description"],["type","hidden","formControlName","id"],["appearance","outline",1,"form-field"],["matInput","","placeholder","Nom","formControlName","name"],["appearance","outline","class","form-field",4,"ngIf"],["matInput","","placeholder","Nombre de personnes","formControlName","numberOfPeople"],["formControlName","type"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"ingredient",3,"formGroupName"],["type","hidden","formControlName","ingredientId",3,"value"],["matInput","","placeholder","Quantit\xe9","formControlName","quantity"],["formControlName","unity"],[1,"step",3,"formGroupName"],["type","hidden","formControlName","stepId",3,"value"],["matInput","","placeholder","Description","formControlName","description"]],template:function(n,o){1&n&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.createRecipe()}),t.TgZ(1,"h2"),t._uU(2,"Description"),t.qZA(),t.YNc(3,P,12,3,"div",1),t.ALo(4,"async"),t.TgZ(5,"div",2)(6,"mat-card",3)(7,"mat-card-header",4)(8,"mat-card-title"),t._uU(9,"Ingr\xe9dients"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return o.addIngredient()}),t.TgZ(11,"mat-icon"),t._uU(12,"add"),t.qZA()()(),t.TgZ(13,"mat-card-content",6),t.YNc(14,M,2,0,"p",7),t.YNc(15,y,15,5,"div",8),t.qZA()(),t.TgZ(16,"mat-card",3)(17,"mat-card-header",4)(18,"mat-card-title"),t._uU(19,"Pr\xe9paration"),t.qZA(),t.TgZ(20,"button",5),t.NdJ("click",function(){return o.addStep()}),t.TgZ(21,"mat-icon"),t._uU(22,"add"),t.qZA()()(),t.TgZ(23,"mat-card-content",9),t.YNc(24,R,2,0,"p",7),t.YNc(25,N,9,2,"div",10),t.qZA()()(),t.TgZ(26,"div",11)(27,"button",12),t._uU(28,"Annuler"),t.qZA(),t.TgZ(29,"button",13),t._uU(30," Enregistrer "),t.qZA()()()),2&n&&(t.Q6J("formGroup",o.form),t.xp6(3),t.Q6J("ngIf",t.lcZ(4,8,o.recipesCount$)),t.xp6(11),t.Q6J("ngIf",0==o.ingredients.controls.length),t.xp6(1),t.Q6J("ngForOf",o.ingredients.controls),t.xp6(9),t.Q6J("ngIf",0==o.steps.controls.length),t.xp6(1),t.Q6J("ngForOf",o.steps.controls),t.xp6(2),t.Q6J("routerLink",t.DdM(10,D)),t.xp6(2),t.Q6J("disabled",!o.isFormValid))},dependencies:[p.ez,p.sg,p.O5,p.Ov,l.UX,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,l.x0,l.CE,s.Bz,s.rH,m.QW,m.a8,m.dn,m.dk,m.n5,T.Is,u.ot,u.lW,u.RK,Z.c,Z.Nt,f.KE,f.hX,C.LD,C.gD,x.ey,E.Ps,E.Hw,v.Nh,f.lN],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex:1;overflow-x:hidden;overflow-y:hidden;padding:16px}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;overflow-x:hidden;overflow-y:hidden}.description[_ngcontent-%COMP%]{display:flex;gap:16px}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;overflow-x:hidden;overflow-y:scroll;gap:16px}.content[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{flex:1}.content[_ngcontent-%COMP%]   .column-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.content[_ngcontent-%COMP%]   .column-actions[_ngcontent-%COMP%]{justify-content:flex-end}.form-field[_ngcontent-%COMP%]{flex:1;max-width:400px}.ingredient[_ngcontent-%COMP%], .step[_ngcontent-%COMP%]{display:flex;gap:16px}.actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:16px}"]}),a})()}}]);